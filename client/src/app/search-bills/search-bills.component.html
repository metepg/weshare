<p-sidebar
  [(visible)]="sidebarVisible"
  (onHide)="handleSidebarHide()"
  position="right">
  <div
    style="display: flex; justify-content: center; align-items: center; margin-top: 30px">
    <form
      (ngSubmit)="onSubmit()"
      [formGroup]="searchForm"
      style="border: 1px solid #ccc; border-radius: 8px; padding: 20px; width: 300px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);"
    >
      <!--Search word-->
      <p-iconField iconPosition="right">
        <p-inputIcon styleClass="pi pi-tag"></p-inputIcon>
        <input
          type="text"
          pInputText
          placeholder="Kuvaus"
          formControlName="description"
          style="width: 100%; margin-bottom: 10px;"
        >
      </p-iconField>

      <!--Category-->
      <p-multiSelect
        [options]="categories"
        formControlName="categories"
        showHeader="false"
        showClear="true"
        optionLabel="label"
        [selectedItemsLabel]="getSelectedItemsLabel()"
        [maxSelectedLabels]="2"
        [style]="{'width': '100%', 'margin-bottom': '10px'}"
        placeholder="Kategoriat">
      </p-multiSelect>

      <!--Range-->
      <!--    <p-calendar-->
      <!--      formControlName="range"-->
      <!--      [showIcon]="true"-->
      <!--      [showOnFocus]="false"-->
      <!--      selectionMode="range"-->
      <!--      placeholder="Valitse ajanjakso"-->
      <!--      [showButtonBar]="true"-->
      <!--      inputId="buttondisplay"/>-->

      <!--User-->
      <p-multiSelect
        [options]="users"
        formControlName="users"
        showHeader="false"
        optionLabel="label"
        [style]="{'width': '100%', 'margin-bottom': '10px'}"
        placeholder="Käyttäjät">
      </p-multiSelect>

      <p-button
        styleClass="p-button-submit"
        [style]="{'width': '100%', 'margin-top': '10px', 'display': 'flex', 'justify-content': 'center'}"
        type="submit">Hae laskut
      </p-button>
    </form>
  </div>
</p-sidebar>

@if (isLoading) {
  <div style="display: flex; margin-top: 50px; justify-content: center">
    <p-progressSpinner ariaLabel="Haku käynnissä"/>
  </div>
} @else {
  @if (bills && bills.length > 0) {
    <div class="p-grid p-justify-center" style="margin-top: 20px">
      <div class="p-col-12 p-md-10 p-lg-8">
        <p-table [value]="bills" [scrollable]="true" scrollHeight="600px" styleClass="p-datatable-gridlines p-datatable-sm">
          <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="owner">Kuka <br>
                <p-sortIcon field="owner"/>
              </th>
              <th pSortableColumn="description">Kuvaus <br>
                <p-sortIcon field="description"/>
              </th>
              <th pSortableColumn="amount">Määrä <br>
                <p-sortIcon field="amount"/>
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-bill>
            <tr>
              <td>{{ bill.owner}}
                <i style="font-size: 8px">{{" (" + (bill.date | date: 'd.MM.YY') + ")" }}</i>
              </td>
              <td>{{ bill.description }}</td>
              <td>{{ bill.amount | number:'1.2-2' }}€</td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  } @else {
    <p style="text-align: center; font-size: 16px; margin-top: 30px">Ei
      laskuja</p>
  }
}

