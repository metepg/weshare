<p-sidebar
  [(visible)]="sidebarVisible"
  (onHide)="handleSidebarHide()"
  position="right">
  <div
    style="display: flex; justify-content: center; align-items: center; margin-top: 30px">
    <form
      (ngSubmit)="onSubmit()"
      [formGroup]="searchForm"
      style="border: 1px solid #ccc; border-radius: 8px; padding: 20px; width: 300px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);"
    >
      <!--Search word-->
      <p-iconField iconPosition="right">
        <p-inputIcon styleClass="pi pi-tag"></p-inputIcon>
        <input
          type="text"
          pInputText
          [placeholder]=" 'description' | translate"
          formControlName="description"
          style="width: 100%; margin-bottom: 10px;"
        >
      </p-iconField>

      <!--Category-->
      <p-multiSelect
        [options]="categories"
        formControlName="categories"
        showClear="true"
        [filter]="false"
        showToggleAll="true"
        optionLabel="label"
        [selectedItemsLabel]="getSelectedItemsLabel()"
        [maxSelectedLabels]="2"
        [style]="{'width': '100%', 'margin-bottom': '10px'}"
        [placeholder]="'categories' | translate">
      </p-multiSelect>

      <!--User-->
      <p-multiSelect
        [options]="users"
        formControlName="users"
        [showHeader]="false"
        optionLabel="label"
        [style]="{'width': '100%', 'margin-bottom': '10px'}"
        placeholder="Käyttäjä">
      </p-multiSelect>

      <p-button
        styleClass="p-button-submit"
        [style]="{'width': '100%', 'margin-top': '10px', 'display': 'flex', 'justify-content': 'center'}"
        type="submit">{{ 'search' | translate}}
      </p-button>
    </form>
  </div>
</p-sidebar>

@if (isLoading) {
  <div style="display: flex; margin-top: 50px; justify-content: center">
    <p-progressSpinner ariaLabel="Haku käynnissä"/>
  </div>
} @else {
  @if (bills && bills.length > 0) {
    <div class="p-grid p-justify-center" style="margin-top: 20px">
      <div class="p-col-12 p-md-10 p-lg-8">
        <p-table
          [value]="bills" 
          [scrollable]="true" 
          scrollHeight="600px" 
          styleClass="p-datatable-gridlines p-datatable-sm">
          <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="owner">{{ 'who' | translate}} <br>
                <p-sortIcon field="owner"/>
              </th>
              <th pSortableColumn="description">{{ 'description' | translate}} <br>
                <p-sortIcon field="description"/>
              </th>
              <th pSortableColumn="amount">{{ 'amount' | translate}} <br>
                <p-sortIcon field="amount"/>
              </th>
              <th pSortableColumn="date">{{ 'dateShort' | translate}} <br>
                <p-sortIcon field="date"/>
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-bill>
            <tr>
              <td>{{ bill.owner.name}}</td>
              <td>{{ bill.description }}</td>
              <td>{{ bill.ownAmount | number:'1.2-2' }}{{ 'currency' | translate}}</td>
              <td>{{ bill.date | date: 'd.M.YY' }}</td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  } @else {
    <p style="text-align: center; font-size: 16px; margin-top: 30px">{{ 'noBillsFound' | translate}}</p>
  }
}

